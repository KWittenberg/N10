<!-- Search Card Component -->

<div class="card mb-3 custom-card">
    <div class="row g-0">
        <div class="col-md-2">
            <a href="movie/@Entity.Id" target="_blank">
                <img src="@PosterUrl" class="img-fluid rounded-start" alt="@Entity.Title cover" loading="lazy">
            </a>
        </div>
        <div class="col-md-10">
            <div class="card-body">
                <a href="movie/@Entity.Id" class="text-decoration-none" target="_blank">
                    <h4 class="fw-bold">
                        @Entity.Title
                        @if (!IsSameTitle)
                        {
                            <span class="ms-4 h6 text-muted">@Entity.OriginalTitle</span>
                        }
                    </h4>
                </a>

                <div class="mt-1">
                    <small class="text-body-secondary">@FormattedReleaseDate</small>
                    <span class="card-text"><small class="text-body-secondary"> | Tmdb: @Entity.Id</small></span>
                </div>

                <div class="mt-3">
                    <h6 class="d-flex align-items-center gap-2">
                        Genres:
                        @foreach (var genre in Entity.GenreIds ?? [])
                        {
                            <span class="badge bg-primary">@genre</span>
                        }
                    </h6>
                </div>

                <div class="mt-3 d-flex align-items-center gap-3">
                    <h6 class="mb-0">
                        <i class="fas fa-star text-warning me-1"></i>
                        Score: @Entity.VoteAverage.ToString("F1")
                    </h6>
                    @if (Entity.VoteCount > 0)
                    {
                        <small class="text-body-secondary">@Entity.VoteCount.ToString("N0") votes</small>
                    }
                </div>

                @if (!string.IsNullOrWhiteSpace(Entity.Overview))
                {
                    <div class="mt-3">
                        <h5 class="lead fw-bold">Overview</h5>
                        <p class="card-text">@Entity.Overview</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>


@code
{
    [Parameter, EditorRequired] public TmdbSearch Entity { get; set; } = null!;

    string PosterUrl => $"{Globals.BaseTmdbImageUrl}{Entity.PosterPath}";
    bool IsSameTitle => Entity.Title == Entity.OriginalTitle;
    string FormattedReleaseDate => GetFormattedReleaseDate();

    string GetFormattedReleaseDate()
    {
        if (string.IsNullOrEmpty(Entity.ReleaseDate) || !DateTime.TryParse(Entity.ReleaseDate, out var releaseDate)) return string.Empty;

        return releaseDate.ToString("dd. MMMM, yyyy.");
    }
}