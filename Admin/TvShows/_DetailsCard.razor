<div class="card mb-3 custom-card">
    <div class="row g-0">
        <div class="col-md-2">
            <a href="tv/@Entity.Id" target="_blank">
                <img src="@PosterUrl" class="img-fluid rounded-start" alt="@Entity.Name cover" loading="lazy">
            </a>
        </div>
        <div class="col-md-10">
            <div class="card-body">
                <a href="tv/@Entity.Id" class="text-decoration-none" target="_blank">
                    <h4 class="fw-bold">
                        @Entity.Name
                        @if (!IsSameName)
                        {
                            <span class="ms-4 h6 text-muted">@Entity.OriginalName</span>
                        }
                    </h4>
                </a>

                <p class="m-0 text-muted fst-italic">@Entity.Tagline</p>

                <div class="mt-1">
                    <small class="text-body-secondary">@FirstAirDate</small>
                    <small class="text-body-secondary">@LastAirDate</small>
                    <span class="card-text"><small class="text-body-secondary"> | Tmdb: @Entity.Id</small></span>
                    <p>Seasons: <span class="h6">@Entity.NumberOfSeasons</span> Episodes: <span class="h6">@Entity.NumberOfEpisodes</span></p>
                </div>

                <div class="mt-3">
                    <h6 class="d-flex align-items-center gap-2">
                        Genres:
                        @foreach (var genre in Entity.Genres ?? [])
                        {
                            <span class="badge bg-primary">@genre.Name</span>
                        }
                    </h6>
                </div>

                <div class="mt-3 d-flex align-items-center gap-3">
                    <h6 class="mb-0">
                        <i class="fas fa-star text-warning me-1"></i>
                        Score: @Entity.VoteAverage.ToString("F1")
                    </h6>
                    @if (Entity.VoteCount > 0)
                    {
                        <small class="text-body-secondary">@Entity.VoteCount.ToString("N0") votes</small>
                    }
                </div>

                @if (!string.IsNullOrWhiteSpace(Entity.Overview))
                {
                    <div class="mt-3">
                        <h5 class="lead fw-bold">Overview</h5>
                        <p class="card-text">@Entity.Overview</p>
                    </div>
                }
            </div>
        </div>
    </div>
</div>


@code
{
    [Parameter, EditorRequired] public TmdbTvShowDetails Entity { get; set; } = null!;

    string PosterUrl => $"{Globals.BaseTmdbImageUrl}{Entity.PosterPath}";
    bool IsSameName => Entity.Name == Entity.OriginalName;
    string FirstAirDate => GetFirstAirDate();
    string LastAirDate => GetLastAirDate();

    string GetFirstAirDate()
    {
        if (string.IsNullOrEmpty(Entity.FirstAirDate) || !DateTime.TryParse(Entity.FirstAirDate, out var firstAirDate)) return string.Empty;

        return firstAirDate.ToString("dd. MMMM, yyyy.");
    }

    string GetLastAirDate()
    {
        if (string.IsNullOrEmpty(Entity.LastAirDate) || !DateTime.TryParse(Entity.LastAirDate, out var lastAirDate)) return string.Empty;

        return $"- {lastAirDate.ToString("dd. MMMM, yyyy.")}";
    }
}