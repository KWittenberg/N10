<!-- Page Header -->
<div class="bg-header"></div>
<div class="@App?.GetContentClass() page-header">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb bg-transparent">
            <li class="breadcrumb-item"><span @onclick="() => OnSelectFolderId.InvokeAsync(null)"><i class="text-white bi bi-stickies-fill"></i></span></li>

            @foreach (var crumb in CurrentPath)
            {
                <li class="breadcrumb-item"><span @onclick="() => OnSelectFolderId.InvokeAsync(crumb.Id)">@crumb.Name</span></li>
            }


            <button type="button" class="ms-3 btn btn-sm btn-outline-secondary rounded-pill bi bi-plus" @onclick="() => OnAddFolderButtonClick.InvokeAsync()">New Folder</button>
        </ol>
    </nav>

    @if (!string.IsNullOrEmpty(AddButtonText))
    {
        <div class="ms-auto text-end">
            @if (string.IsNullOrEmpty(NoteUrl))
            {
                <button type="button" class="btn btn-primary rounded-pill btn-sm" @onclick="() => OnAddNoteButtonClick.InvokeAsync()">
                    <i class="bi bi-plus-circle me-2"></i>@AddButtonText
                </button>
            }
            else
            {
                <a type="button" class="btn btn-primary rounded-pill btn-sm" href="@NewNoteUrl">
                    <i class="bi bi-plus-circle me-2"></i>@AddButtonText
                </a>
            }
        </div>
    }
</div>


@code {
    [CascadingParameter] AppState? App { get; set; }

    [Parameter] public List<NoteFolderDto> CurrentPath { get; set; } = [];
    [Parameter] public EventCallback<int?> OnSelectFolderId { get; set; }

    [Parameter] public int? CurrentFolderId { get; set; }

    [Parameter] public string? Title { get; set; } = string.Empty;

    [Parameter] public string? AddButtonText { get; set; } = string.Empty;

    [Parameter] public string? NoteUrl { get; set; } = string.Empty;

    [Parameter] public EventCallback OnAddFolderButtonClick { get; set; }
    [Parameter] public EventCallback OnAddNoteButtonClick { get; set; }

    string? NewNoteUrl;

    protected override async Task OnParametersSetAsync()
    {
        if (CurrentFolderId is not null) NewNoteUrl = $"note?folderId={CurrentFolderId}";
        else NewNoteUrl = NoteUrl;
    }
}